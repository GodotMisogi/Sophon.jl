<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>1D Convection Equation · Sophon.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://YichengDWu.github.io/Sophon.jl/tutorials/convection/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Sophon.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../discontinuous/">Fitting a nonlinear discontinuous function</a></li><li><a class="tocitem" href="../poisson/">1D Poisson&#39;s Equation</a></li><li class="is-active"><a class="tocitem" href>1D Convection Equation</a><ul class="internal"><li><a class="tocitem" href="#Imposing-periodic-boundary-conditions"><span>Imposing periodic boundary conditions</span></a></li><li><a class="tocitem" href="#Respecting-causality"><span>Respecting causality</span></a></li></ul></li><li><a class="tocitem" href="../helmholtz/">2D Helmholtz Equation</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>1D Convection Equation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>1D Convection Equation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/YichengDWu/Sophon.jl/blob/main/docs/src/tutorials/convection.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="D-Convection-Equation"><a class="docs-heading-anchor" href="#D-Convection-Equation">1D Convection Equation</a><a id="D-Convection-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#D-Convection-Equation" title="Permalink"></a></h1><p>Consider the following 1D-convection equation with periodic boundary conditions.</p><p class="math-container">\[\begin{aligned}
&amp;\frac{\partial u}{\partial t}+c \frac{\partial u}{\partial x}=0, x \in[0,1], t \in[0,1] \\
&amp;u(x, 0)=sin(2\pi x) \\
\end{aligned}\]</p><p>First we define the PDE.</p><pre><code class="language-julia hljs">using NeuralPDE, Lux, Random, Sophon, IntervalSets, CairoMakie
using Optimization, OptimizationOptimJL, OptimizationOptimisers

@parameters x, t
@variables u(..)
Dₜ = Differential(t)
Dₓ = Differential(x)

c = 6
eq = Dₜ(u(x,t)) + c * Dₓ(u(x,t)) ~ 0
u_analytic(x,t) = sinpi(2*(x-c*t))

domains = [x ∈ 0..1, t ∈ 0..1]

bcs = [u(x,0) ~ u_analytic(x,0)]

@named convection = PDESystem(eq, bcs, domains, [x,t], [u(x,t)])</code></pre><p class="math-container">\[ \begin{align}
6 \mathrm{\frac{d}{d x}}\left( u\left( x, t \right) \right) + \mathrm{\frac{d}{d t}}\left( u\left( x, t \right) \right) =&amp; 0
\end{align}
 \]</p><h2 id="Imposing-periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Imposing-periodic-boundary-conditions">Imposing periodic boundary conditions</a><a id="Imposing-periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Imposing-periodic-boundary-conditions" title="Permalink"></a></h2><p>We will use <a href="../../#Sophon.BACON-Tuple{Int64, Int64}"><code>BACON</code></a> to impose the boundary conditions. To this end, we simply set <code>period</code> to be one.</p><pre><code class="language-julia hljs">chain = BACON(2,1; hidden_dims = 32, num_layers=5, period = 1, N = 8)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MultiplicativeFilterNet(
    filters = BranchLayer(
        filter_1 = DiscreteFourierFeature(2 =&gt; 32),  # 32 parameters, plus 64
        filter_2 = DiscreteFourierFeature(2 =&gt; 32),  # 32 parameters, plus 64
        filter_3 = DiscreteFourierFeature(2 =&gt; 32),  # 32 parameters, plus 64
        filter_4 = DiscreteFourierFeature(2 =&gt; 32),  # 32 parameters, plus 64
        filter_5 = DiscreteFourierFeature(2 =&gt; 32),  # 32 parameters, plus 64
    ),
    linear_layers = PairwiseFusion(
        Base.Broadcast.BroadcastFunction{typeof(*)}(*)
        layer_1 = Dense(32 =&gt; 32),      # 1_056 parameters
        layer_2 = Dense(32 =&gt; 32),      # 1_056 parameters
        layer_3 = Dense(32 =&gt; 32),      # 1_056 parameters
        layer_4 = Dense(32 =&gt; 32),      # 1_056 parameters
    ),
    output_layer = Dense(32 =&gt; 1),      # 33 parameters
)         # Total: 4_417 parameters,
          #        plus 320 states, summarysize 240 bytes.</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For demonstration purposes, the model is also periodic in time</p></div></div><pre><code class="language-julia hljs">discretization = PhysicsInformedNN(chain, QuasiRandomTraining(300; resampling = false, minibatch = 1); adaptive_loss = NonAdaptiveLoss(; bc_loss_weights = [100]))
prob = discretize(convection, discretization)

@time res = Optimization.solve(prob, LBFGS(); maxiters = 500)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: ComponentVector{Float64}(filters = (filter_1 = (bias = [-0.6608181172031588; 0.7216286021804011; … ; -0.7698874588847868; -0.8787349071036739;;]), filter_2 = (bias = [0.39280319437670547; -0.8862896794614112; … ; -0.9435509573792187; -0.05807857700902731;;]), filter_3 = (bias = [0.5483305652503362; 0.09890978478803392; … ; 0.6948190471411068; 1.0382253707415678;;]), filter_4 = (bias = [0.4225618341543272; -0.9717313295760034; … ; -0.2085140693227308; 0.21167607335853358;;]), filter_5 = (bias = [0.1691223515154604; 0.2745842578691273; … ; -0.4335968474099263; -0.34113457586299445;;])), linear_layers = (layer_1 = (weight = [0.1155282022690858 -0.23650438307755656 … 0.24953543539654366 0.42388940699643884; 0.30173852906719295 -0.3350748569454174 … 0.22961845938793066 -0.06677577000704155; … ; 0.2061237913098379 0.4539926266617484 … 0.12603683002872232 0.05560981406746213; -0.3113622166716647 -0.1418148776726917 … 0.04596623816184566 0.13251606090515855], bias = [-0.10547442303313052; -0.026532133016162977; … ; -0.01722336729097594; 0.1616805665130597;;]), layer_2 = (weight = [-0.11235205272194751 0.23139308876125414 … 0.4338128628445814 0.364444579466159; 0.29200832342793914 -0.18543785187944092 … -0.417129723334533 -0.27222306346966946; … ; 0.17153485549380265 -0.038793229493359574 … -0.18555582994684375 -0.24096697506897455; 0.04879257357795941 -0.10336679788108087 … -0.12837201024184708 -0.3269187163572939], bias = [0.02805635367923161; 0.01809787679522946; … ; 0.08875090293179712; -0.1637703714615685;;]), layer_3 = (weight = [-0.22867262163927346 -0.01966357070784076 … 0.39655534421416594 0.14708952501049513; 0.35200531224823184 0.22461451873135238 … -0.28445650594139826 -0.4016993987212558; … ; -0.43697342332623407 0.35791686517241705 … 0.035588877385136004 0.03690689357895597; -0.42005407025069835 0.4133300719473384 … -0.2487093686039893 0.24149945035410605], bias = [0.0016882617599865125; 0.0013017583578322463; … ; -0.16424852273273846; -0.038236093981345705;;]), layer_4 = (weight = [-0.1611321503956109 -0.32063971678843806 … 0.18121821498258475 -0.33955191630716663; -0.39051819868323767 0.40317678871171125 … 0.04727389776972689 -0.0897414127916316; … ; -0.30778818395453394 0.38293042906897345 … 0.2570370471582912 -0.1921456234014635; -0.1631628143835651 0.11981824991672119 … -0.2789017485663579 0.11439052627660315], bias = [0.031339204218478044; 0.016046484840807455; … ; -0.011692282965878913; 0.025646286802807842;;])), output_layer = (weight = [-0.49188291468478434 0.00786634550416634 … 0.08144150919946161 0.0049453460284310915], bias = [-0.009507542967463194;;]))</code></pre><p>Let&#39;s visualize the result.</p><pre><code class="language-julia hljs">phi = discretization.phi

xs, ts= [infimum(d.domain):0.01:supremum(d.domain) for d in domains]
u_pred = [sum(phi([x,t],res.u)) for x in xs, t in ts]
u_real = u_analytic.(xs,ts&#39;)

fig, ax, hm = CairoMakie.heatmap(ts, xs, u_pred&#39;, axis=(xlabel=&quot;t&quot;, ylabel=&quot;x&quot;, title=&quot;c = $c&quot;))
ax2, hm2 = heatmap(fig[1,end+1], ts,xs, abs.(u_pred&#39; .- u_real&#39;), axis = (xlabel=&quot;t&quot;, ylabel=&quot;x&quot;, title=&quot;Absolute error&quot;))
Colorbar(fig[:, end+1], hm2)</code></pre><p><img src="../convection.png" alt/></p><p>We can verify that our model is indeed, periodic.</p><pre><code class="language-julia hljs">xs, ts= [infimum(d.domain):0.01:supremum(d.domain)*2 for d in domains]
u_pred = [sum(phi([x,t],res.u)) for x in xs, t in ts]
fig, ax, hm = CairoMakie.heatmap(ts, xs, u_pred&#39;, axis=(xlabel=&quot;t&quot;, ylabel=&quot;x&quot;, title=&quot;c = $c&quot;))</code></pre><p><img src="../convection2.png" alt/></p><h2 id="Respecting-causality"><a class="docs-heading-anchor" href="#Respecting-causality">Respecting causality</a><a id="Respecting-causality-1"></a><a class="docs-heading-anchor-permalink" href="#Respecting-causality" title="Permalink"></a></h2><p><a href="../../#Sophon.CausalTraining"><code>CausalTraining</code></a> will only start optimizing the loss of the succeeding time after the loss of the preceding time has been optimized.</p><pre><code class="language-julia hljs">strategy =  CausalTraining(500; init_points = 200, epsilon = 0.01, bc_loss_weights = [100])
function callback(p,l)
    @show l
    strategy.reweight = true
    phi = discretization.phi

    u_pred = [sum(phi([x,t],p)) for x in xs, t in ts]

    fig, ax, hm = CairoMakie.heatmap(ts, xs, u_pred&#39;, axis=(xlabel=&quot;t&quot;, ylabel=&quot;x&quot;, title=&quot;c = $c&quot;))
    #fig = plot(vec(strategy.W))
    display(fig)
    return false
end
discretization = PhysicsInformedNN(chain, strategy)
prob = discretize(convection, discretization)

@time res = Optimization.solve(prob, Adam(0.01); maxiters = 500, callback = callback)

phi = discretization.phi

xs, ts= [infimum(d.domain):0.01:supremum(d.domain) for d in domains]
u_pred = [sum(phi([x,t],res.u)) for x in xs, t in ts]
u_real = u_analytic.(xs,ts&#39;)

fig, ax, hm = CairoMakie.heatmap(ts, xs, u_pred&#39;, axis=(xlabel=&quot;t&quot;, ylabel=&quot;x&quot;, title=&quot;c = $c&quot;))
ax2, hm2 = heatmap(fig[1,end+1], ts,xs, abs.(u_pred&#39; .- u_real&#39;), axis = (xlabel=&quot;t&quot;, ylabel=&quot;x&quot;, title=&quot;Absolute error&quot;))
Colorbar(fig[:, end+1], hm2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">l = 9262.08743889258
l = 192.4217105304968
l = 173.00617439092613
l = 163.54022818354926
l = 159.18161103417498
l = 159.34763373265804
l = 159.82237755778
l = 157.5012651212544
l = 153.16417095641975
l = 147.7932728809264
l = 142.10272790345482
l = 136.88416304337122
l = 133.031991306632
l = 130.70651870264356
l = 129.42881138275433
l = 128.12065367462276
l = 126.53673838540435
l = 125.33356704425982
l = 124.19340734142861
l = 122.63269746376623
l = 121.56041348064538
l = 120.88144327956718
l = 120.27619569006784
l = 119.89941830855635
l = 119.67528072583282
l = 119.29748104633252
l = 118.77375981207673
l = 118.2252190272425
l = 117.68669850571644
l = 117.1864999839732
l = 116.7765208855909
l = 116.46744581691618
l = 116.24004558085866
l = 116.07947552772649
l = 115.96687826150588
l = 115.89054102916339
l = 115.83984532382962
l = 115.79436671484578
l = 115.71907470507946
l = 115.56084921763767
l = 115.24688942897097
l = 114.68357043734409
l = 113.7572531606967
l = 112.3437996715578
l = 110.3330971129295
l = 107.65657534937021
l = 104.27769318078686
l = 100.12614938944282
l = 95.04606040252818
l = 88.86382205888967
l = 81.58899062105723
l = 73.63521017634596
l = 65.86683257828656
l = 59.32477833679377
l = 54.740861531602356
l = 52.19825367573379
l = 51.184703789615845
l = 50.92476774564119
l = 50.71020503810088
l = 50.07230665373484
l = 48.80955114579101
l = 46.942563125257394
l = 44.64677136404424
l = 42.181106459062825
l = 39.81743786194374
l = 37.77720024011596
l = 36.186610522693734
l = 35.060870204719585
l = 34.319345802465534
l = 33.82319698624338
l = 33.42074836263696
l = 32.98657228960177
l = 32.44560976896007
l = 31.779892768148343
l = 31.020080071525733
l = 30.22670328698216
l = 29.467333432420986
l = 28.796088824416444
l = 28.240707558554476
l = 27.799683248245756
l = 27.44849035225812
l = 27.151149890983298
l = 26.87242948561307
l = 26.586896954713293
l = 26.28300934218747
l = 25.962381673775837
l = 25.635687816799
l = 25.317143365455863
l = 25.019364106591162
l = 24.74984282413617
l = 24.509589682490777
l = 24.293831674882636
l = 24.094190401718066
l = 23.90150934060148
l = 23.708479321514716
l = 23.51137875862339
l = 23.31055151087183
l = 23.109622717369554
l = 22.913814016284395
l = 22.727964839631703
l = 22.55491524058118
l = 22.394736335037678
l = 22.244967412710736
l = 22.101659501097956
l = 21.960769839407
l = 21.819386274729744
l = 21.676388040113235
l = 21.53239923507379
l = 21.389158591208897
l = 21.248617871940375
l = 21.112135398465732
l = 20.980046560500192
l = 20.851713574671766
l = 20.72595693361404
l = 20.601629876357997
l = 20.47806804388387
l = 20.35523459113665
l = 20.233540421969224
l = 20.11347272076049
l = 19.9952406616557
l = 19.878614101587814
l = 19.76301442019308
l = 19.647782859191143
l = 19.53247078436671
l = 19.41700391764136
l = 19.30165402245791
l = 19.186855233749586
l = 19.072972291655923
l = 18.960134454460828
l = 18.848199468360605
l = 18.73684117108217
l = 18.625700294266487
l = 18.51452245048577
l = 18.403228349330227
l = 18.291900840759737
l = 18.18071008871782
l = 18.069818005019428
l = 17.959302705059287
l = 17.849128219979285
l = 17.73916295250703
l = 17.629231395528176
l = 17.519173861685736
l = 17.408890588271046
l = 17.29835708942062
l = 17.18761119692978
l = 17.076722634662882
l = 16.965759615911466
l = 16.854764174973344
l = 16.74374185902954
l = 16.632665437847486
l = 16.52148833598789
l = 16.410161765505052
l = 16.298649597027936
l = 16.18693660458179
l = 16.075028629854128
l = 15.962946606309465
l = 15.850718722782002
l = 15.738374983922895
l = 15.62594608338145
l = 15.51346544265044
l = 15.400971514779776
l = 15.288507969233763
l = 15.176121381394063
l = 15.06385783921651
l = 14.95176023985979
l = 14.839867099919848
l = 14.728212538235049
l = 14.616826680204603
l = 14.505736147961706
l = 14.39496489430914
l = 14.284535755004566
l = 14.17447265769486
l = 14.06480287451367
l = 13.955558524315048
l = 13.846776818711579
l = 13.738499087227499
l = 13.63076905982934
l = 13.523631063546468
l = 13.417128670605997
l = 13.311304024607928
l = 13.206197712736419
l = 13.101848812131145
l = 12.99829475746064
l = 12.895570923126439
l = 12.793710108456217
l = 12.692742232827664
l = 12.592694412209319
l = 12.49359133738269
l = 12.395455712521489
l = 12.298308568859806
l = 12.202169426593136
l = 12.10705640194566
l = 12.012986340197177
l = 11.919974966799003
l = 11.828036988303584
l = 11.737186087136966
l = 11.647434805139286
l = 11.558794345515787
l = 11.471274330373028
l = 11.384882562276653
l = 11.299624852389275
l = 11.215504977339041
l = 11.132524778691145
l = 11.050684355469285
l = 10.969982261820352
l = 10.890415648269915
l = 10.811980346319872
l = 10.734670945497157
l = 10.658480915870427
l = 10.583402783891994
l = 10.509428323997236
l = 10.436548704747981
l = 10.36475454319645
l = 10.29403586643053
l = 10.224382023576394
l = 10.155781612476638
l = 10.088222465291196
l = 10.021691687401052
l = 9.956175713534414
l = 9.89166033816396
l = 9.828130721110517
l = 9.765571401058562
l = 9.703966360350739
l = 9.643299149358125
l = 9.583553041373788
l = 9.524711164665446
l = 9.466756573339524
l = 9.409672248274134
l = 9.353441053409664
l = 9.298045683823974
l = 9.243468637554242
l = 9.189692224000629
l = 9.136698604613075
l = 9.084469853041162
l = 9.032988023757602
l = 8.98223521996606
l = 8.932193655941706
l = 8.882845706128535
l = 8.834173934881399
l = 8.786161106226801
l = 8.738790181371915
l = 8.692044318592195
l = 8.645906888162816
l = 8.60036150745932
l = 8.555392093739801
l = 8.510982920129713
l = 8.46711866193247
l = 8.423784419528003
l = 8.380965718418945
l = 8.33864849341949
l = 8.29681906984626
l = 8.25546415336509
l = 8.214570832413706
l = 8.174126593681402
l = 8.134119343537495
l = 8.094537429678944
l = 8.055369653520458
l = 8.016605269345966
l = 7.978233969840751
l = 7.9402458628646695
l = 7.902631449420376
l = 7.865381607962052
l = 7.828487587802831
l = 7.791941008141416
l = 7.7557338563392575
l = 7.719858477954565
l = 7.684307557062981
l = 7.649074088152752
l = 7.614151344237451
l = 7.579532848908757
l = 7.545212356765567
l = 7.511183842358906
l = 7.47744149862644
l = 7.443979736352064
l = 7.410793182933177
l = 7.377876672654622
l = 7.345225230882577
l = 7.31283405285535
l = 7.280698484369857
l = 7.248814005894243
l = 7.217176225131209
l = 7.185780874186424
l = 7.154623808991329
l = 7.123701007366982
l = 7.093008564980782
l = 7.062542688435025
l = 7.032299688942727
l = 7.002275977425019
l = 6.972468062035253
l = 6.942872548471604
l = 6.913486138441263
l = 6.884305627065388
l = 6.855327897726364
l = 6.8265499145568285
l = 6.797968715279436
l = 6.769581406124423
l = 6.741385159471248
l = 6.713377213793571
l = 6.6855548752765275
l = 6.657915518092111
l = 6.630456583761554
l = 6.603175579139919
l = 6.576070072681033
l = 6.54913769196016
l = 6.522376121652229
l = 6.495783102431606
l = 6.469356430411771
l = 6.44309395570941
l = 6.416993582433349
l = 6.391053266749606
l = 6.365271015900364
l = 6.339644887184657
l = 6.314172986354827
l = 6.288853466494675
l = 6.2636845265787295
l = 6.238664409790138
l = 6.213791402780264
l = 6.1890638350980804
l = 6.164480078418181
l = 6.140038546484445
l = 6.115737693341757
l = 6.091576012010548
l = 6.067552032689209
l = 6.043664321346974
l = 6.0199114794889725
l = 5.996292143909036
l = 5.97280498731555
l = 5.9494487169738575
l = 5.926222074032299
l = 5.903123831174942
l = 5.880152790952224
l = 5.857307784579749
l = 5.834587671194257
l = 5.8119913378182755
l = 5.7895176986294725
l = 5.767165693773295
l = 5.744934288662944
l = 5.722822473022685
l = 5.700829259575678
l = 5.678953685031521
l = 5.65719480846875
l = 5.635551711260972
l = 5.614023495878175
l = 5.592609284555198
l = 5.57130821812938
l = 5.5501194557122755
l = 5.529042174210899
l = 5.508075568298716
l = 5.487218849795299
l = 5.466471247354049
l = 5.445832005093663
l = 5.425300382652112
l = 5.404875654069037
l = 5.384557107385277
l = 5.364344044293313
l = 5.344235779482299
l = 5.324231640347715
l = 5.304330966997672
l = 5.284533111181254
l = 5.264837436793789
l = 5.245243318492308
l = 5.225750141492599
l = 5.206357300843068
l = 5.187064201190421
l = 5.16787025631636
l = 5.148774889368094
l = 5.129777532534608
l = 5.110877626366642
l = 5.092074619614639
l = 5.073367968874722
l = 5.054757138105014
l = 5.03624159850814
l = 5.017820828296145
l = 4.999494312356014
l = 4.981261541879516
l = 4.96312201412791
l = 4.945075232081987
l = 4.927120704788195
l = 4.909257946356823
l = 4.891486476448966
l = 4.873805819671887
l = 4.856215505618844
l = 4.838715068295501
l = 4.821304046145651
l = 4.803981982209728
l = 4.786748423192002
l = 4.769602919826838
l = 4.7525450267085185
l = 4.735574301866758
l = 4.718690307055062
l = 4.7018926069484
l = 4.685180769253419
l = 4.668554364916856
l = 4.652012967366044
l = 4.635556152738473
l = 4.619183500045569
l = 4.602894590182196
l = 4.586689006595423
l = 4.570566334538036
l = 4.554526161420361
l = 4.538568076544912
l = 4.522691670617678
l = 4.506896535963979
l = 4.4911822664628955
l = 4.47554845704041
l = 4.459994703909582
l = 4.44452060413756
l = 4.429125755707672
l = 4.413809757510116
l = 4.398572208916943
l = 4.383412709828727
l = 4.368330860548179
l = 4.3533262614912935
l = 4.338398513488619
l = 4.323547216950302
l = 4.308771972513056
l = 4.294072380369541
l = 4.279448040496658
l = 4.264898552123821
l = 4.250423514327081
l = 4.236022524906543
l = 4.22169518136
l = 4.207441079844912
l = 4.193259815798344
l = 4.179150983363399
l = 4.165114175201321
l = 4.151148982984684
l = 4.137254996651561
l = 4.123431804729812
l = 4.109678993887277
l = 4.095996149289062
l = 4.082382854081242
l = 4.068838689477365
l = 4.055363234688682
l = 4.0419560667622765
l = 4.028616760904444
l = 4.0153448896464
l = 4.002140023407701
l = 3.9890017300951186
l = 3.9759295753593684
l = 3.962923122176745
l = 3.94998193125358
l = 3.937105559979061
l = 3.924293564151022
l = 3.9115454959211675
l = 3.8988609052836147
l = 3.8862393392726298
l = 3.8736803421359793
l = 3.861183455327475
l = 3.848748217751579
l = 3.8363741651339507
l = 3.824060830578508
l = 3.8118077443062828
l = 3.7996144337273448
l = 3.787480423460351
l = 3.7754052353037064
l = 3.763388388472647
l = 3.751429399133842
l = 3.7395277810954735
l = 3.7276830451428906
l = 3.715894699655661
l = 3.7041622505303713
l = 3.69248520091093
l = 3.6808630515281764
l = 3.6692953008352105
l = 3.6577814447842814
l = 3.6463209770570764
l = 3.634913389333139
l = 3.62355817100206
l = 3.6122548093401248
l = 3.601002789769939
l = 3.5898015958722116
l = 3.5786507094178206
l = 3.567549610575499
l = 3.5564977777616744
l = 3.545494688074624
l = 3.534539817311342
l = 3.523632639702738
l = 3.512772628511104
l = 3.5019592560957316
l = 3.491191993712023
l = 3.480470311738315
l = 3.4697936803396656
l = 3.459161568397614
l = 3.4485734450035577
l = 3.4380287785703363
l = 3.4275270373733733
l = 3.417067689851277
l = 3.406650204082187
l = 3.3962740488111214
l = 3.3859386927248467
l = 3.3756436052132353
l = 3.365388256209342
l = 3.355172116251478
l = 3.3449946568495244
l = 3.3348553502558835
l = 3.324753670241562
l = 3.31468909135751
l = 3.3046610897838944
l = 3.2946691431477797
l = 3.2946691431477797
359.182938 seconds (599.60 M allocations: 180.711 GiB, 15.03% gc time, 10.69% compilation time)</code></pre><p><img src="../convection3.png" alt/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The hyperparameter <code>epsilon</code> in <a href="../../#Sophon.CausalTraining"><code>CausalTraining</code></a> is very sensitive.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../poisson/">« 1D Poisson&#39;s Equation</a><a class="docs-footer-nextpage" href="../helmholtz/">2D Helmholtz Equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 13 September 2022 22:17">Tuesday 13 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
